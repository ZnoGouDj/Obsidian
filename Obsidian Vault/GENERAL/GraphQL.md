GraphQL это **синтаксис ([[протокол]]), который описывает как запрашивать данные**, и используется клиентом для загрузки данных с сервера. GraphQL имеет три основные характеристики:

-   Позволяет клиенту точно указать, какие данные ему нужны.
-   Облегчает объединение данных из нескольких источников.
-   Использует систему типов для описания данных.

<span style="font-weight: bold; color: mediumvioletred;">Решает проблему избыточных данных</span>, когда например классический HTTP-сервер запрашивает все данные о пользователе, хотя нам нужно только имя. В случае GraphQL вернутся только запрошенные параметры.

Все начинается с <span style="font-weight: bold; color: #FFB514;">построения схемы.</span> В ней мы <span style="font-weight: bold; color: deepskyblue;">описываем типы, мутации, запросы:</span>
```ts
type User {
	id: ID
	username: String
	age: Int
	posts: [Post]
}
```

Далее строится <span style="font-weight: bold; color: #FFB514;">query или запрос</span>. Описывает, какие данные мы должны получить с сервера.
В данном примере <span style="font-weight: bold; color: deepskyblue;">запрашиваем пользователей и берем от них username и age:</span>
```ts
query {
	users {
		username
		age
	}
}
```

Далее <span style="font-weight: bold; color: #FFB514;">мутации.</span> Позволяют какие-то данные добавить, обновить, перезаписать. То есть аналог POST или  PUT запроса в HTTP.
В данном примере <span style="font-weight: bold; color: deepskyblue;">создаем пользователя Вася 22 года, и говорим GraphQL-серверу "верни нам в ответ на эту мутацию его id и username":</span>
```ts
mutation createUser{
	addUser(username: 'Vasya', age: 22) {
		id, username
	}
}
```

Далее <span style="font-weight: bold; color: #FFB514;">subscription или подписки. </span> С помощью них клиент слушает изменения в базе данных в режиме реального времени. Под капотом используют [[WebSocket]].
```ts 
subscription listenPostLikes {
	listenPostLikes {
		title 
		likes
	}
}
```

Слой GraphQL находится между клиентом и одним или несколькими источниками данных; он принимает запросы клиентов и возвращает необходимые данные в соответствии с переданными инструкциями.

Пользоваться старой [[RestAPI]]-моделью это как заказывать пиццу, затем заказывать доставку продуктов, а затем звонить в химчистку, чтобы забрать одежду. Три магазина – три телефонных звонка.

![[RESTapiBadExample.png]]

GraphQL похож на личного помощника: вы можете передать ему адреса всех трех мест, а затем просто запрашивать то, что вам нужно («принеси мне мою одежду, большую пиццу и два десятка яиц») и ждать их получения.

![[GraphQLGoodExample.png]]