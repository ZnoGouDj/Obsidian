## CORS

*cross-origin resourse sharing — это механизм, который позволяет браузерам запрашивать данные со сторонних URL-адресов (или источников) и является распространенной проблемой для веб-разработчиков.

%%***URL** (Uniform Resource Locator — унифицированный указатель ресурса) — это адрес ресурса в интернете.*%% далее `адрес`

Мы можем попытаться использовать изображение на своем сайте, которое находится на другом сайте, и получить сломанную картинку. 
Или наш сайт может попытаться получить данные с АПИ, и свалиться с `CORS-error` в консоли. 

Это происходит потому что браузер реализует определенную политику безопасности. Он позволяет сайтам запрашивать картинки и данные с их собственных адресов, но блокирует внешние адреса, если определенные условия не соблюдены. 

Когда браузер делает request, он добавляет туда заголовок источника. Если  запрос приходит на сервер с совпадающим источником, значит проблем нет, можно разрешать. 

НО если этот запрос идет по другому адресу, то это уже не собственный источник, и в response сервер добавит заголовок `access-control-allow-origin`. И это значение должно совпадать с заголовком `Origin` в запросе. 
Иначе, браузер прервет получение ответа и выкинет ошибку в браузере, но по причинам безопасности нам поступит очень мало информации об ошибке. 

Либо же адрес может быть черным ящиком, который может позволять делать запрос кому угодно.

Решение лежит на сервере. Если мы не контролируем сервер — нам не повезло. Если мы контролируем сервер — нам просто нужно настроить его на response с нужным заголовком. 

В [[express.js]] например, это может быть достигнуто одной строчкой [[middleware]] кода, который говорит серверу включить CORS заголовки в каждый response. 

```javascript
app.use(cors({ origin: 'https://foo.com' }))
```

Определенные http запросы, типа PUT, PATCH, DELETE, должны быть так скажем "проверены" перед полетом на сервер. Браузер автоматически знает, когда это сделать %%(и сперва сделает запрос, используя options http verb??)%%. После такой проверки сервер разрешит делать запросы этими методами, и можно будет делать запросы без ошибок. 

#CORS, #Middleware